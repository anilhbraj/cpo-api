<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>JdbcCpoMetaAdapter.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">cpo-jdbc</a> &gt; <a href="index.source.html" class="el_package">org.synchronoss.cpo.jdbc.meta</a> &gt; <span class="el_source">JdbcCpoMetaAdapter.java</span></div><h1>JdbcCpoMetaAdapter.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2003-2012 David E. Berry
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * A copy of the GNU Lesser General Public License may also be found at
 * http://www.gnu.org/licenses/lgpl.txt
 */
package org.synchronoss.cpo.jdbc.meta;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.synchronoss.cpo.core.cpoCoreMeta.*;
import org.synchronoss.cpo.jdbc.*;
import org.synchronoss.cpo.jdbc.cpoJdbcMeta.*;
import org.synchronoss.cpo.parser.BoundExpressionParser;
import org.synchronoss.cpo.meta.AbstractCpoMetaAdapter;
import org.synchronoss.cpo.meta.DataTypeMapEntry;
import org.synchronoss.cpo.meta.DataTypeMapper;
import org.synchronoss.cpo.meta.domain.*;
import org.synchronoss.cpo.parser.ExpressionParser;

import java.math.BigDecimal;
import java.util.*;

/**
 * @author dberry
 */
<span class="fc" id="L41">public class JdbcCpoMetaAdapter extends AbstractCpoMetaAdapter {</span>
<span class="fc" id="L42">  private static final Logger logger = LoggerFactory.getLogger(JdbcCpoMetaAdapter.class);</span>
<span class="fc" id="L43">  private static final DataTypeMapEntry&lt;String&gt; defaultDataTypeMapEntry = new DataTypeMapEntry&lt;&gt;(java.sql.Types.VARCHAR, &quot;VARCHAR&quot;, String.class); //12</span>
<span class="fc" id="L44">  private static final DataTypeMapper dataTypeMapper = initDataTypeMapper();</span>

  @Override
  protected DataTypeMapper getDataTypeMapper() {
<span class="fc" id="L48">    return dataTypeMapper;</span>
  }

  @Override
  protected void loadCpoAttribute(CpoAttribute cpoAttribute, CtAttribute ctAttribute) {
<span class="fc" id="L53">    super.loadCpoAttribute(cpoAttribute, ctAttribute);</span>

    // cast to the expected subclasses
<span class="fc" id="L56">    JdbcCpoAttribute jdbcAttribute = (JdbcCpoAttribute)cpoAttribute;</span>
<span class="fc" id="L57">    CtJdbcAttribute ctJdbcAttribute = (CtJdbcAttribute)ctAttribute;</span>

<span class="fc" id="L59">    jdbcAttribute.setDbTable(ctJdbcAttribute.getDbTable());</span>
<span class="fc" id="L60">    jdbcAttribute.setDbColumn(ctJdbcAttribute.getDbColumn());</span>
<span class="fc" id="L61">  }</span>

  @Override
  protected void loadCpoArgument(CpoArgument cpoArgument, CtArgument ctArgument) {
<span class="fc" id="L65">    super.loadCpoArgument(cpoArgument, ctArgument);</span>

    // cast to the expected subclasses
<span class="fc" id="L68">    JdbcCpoArgument jdbcArgument = (JdbcCpoArgument)cpoArgument;</span>
<span class="fc" id="L69">    CtJdbcArgument ctJdbcArgument = (CtJdbcArgument)ctArgument;</span>

//    logger.debug(&quot;Setting argument scope to: &quot;+ctJdbcArgument.getScope().toString());
<span class="fc" id="L72">    jdbcArgument.setScope(ctJdbcArgument.getScope().toString());</span>
<span class="fc" id="L73">    jdbcArgument.setTypeInfo(ctJdbcArgument.getTypeInfo());</span>
<span class="fc" id="L74">  }</span>

  @Override
  protected CpoAttribute createCpoAttribute() {
<span class="fc" id="L78">    return new JdbcCpoAttribute();</span>
  }

  @Override
  protected CpoArgument createCpoArgument() {
<span class="fc" id="L83">    return new JdbcCpoArgument();</span>
  }

  @Override
  public ExpressionParser getExpressionParser() {
<span class="nc" id="L88">    return new BoundExpressionParser();</span>
  }

  @Override
  public List&lt;String&gt; getAllowableDataTypes() {
<span class="nc" id="L93">    return dataTypeMapper.getDataTypeNames();</span>
  }

  private static DataTypeMapper initDataTypeMapper() {
<span class="fc" id="L97">    logger.debug(&quot;Initializing the DataMapper&quot;);</span>
<span class="fc" id="L98">    DataTypeMapper dataTypeMapper = new DataTypeMapper(defaultDataTypeMapEntry);</span>

    // JDK 1.4.2 Values
<span class="fc" id="L101">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.CHAR, &quot;CHAR&quot;, String.class)); // 1</span>
<span class="fc" id="L102">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.LONGVARCHAR, &quot;LONGVARCHAR&quot;, String.class)); // -1</span>
<span class="fc" id="L103">    dataTypeMapper.addDataTypeEntry(defaultDataTypeMapEntry); // 12</span>
<span class="fc" id="L104">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.DECIMAL, &quot;DECIMAL&quot;, BigDecimal.class)); // 3</span>
<span class="fc" id="L105">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.NUMERIC, &quot;NUMERIC&quot;, BigDecimal.class)); // 2</span>
<span class="fc" id="L106">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.TINYINT, &quot;TINYINT&quot;, byte.class)); // -6</span>
<span class="fc" id="L107">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.SMALLINT, &quot;SMALLINT&quot;, short.class)); // 5</span>
<span class="fc" id="L108">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.INTEGER, &quot;INTEGER&quot;, int.class)); // 4</span>
<span class="fc" id="L109">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.BIGINT, &quot;BIGINT&quot;, long.class)); // -5</span>
<span class="fc" id="L110">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.REAL, &quot;REAL&quot;, float.class)); // 7</span>
<span class="fc" id="L111">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.FLOAT, &quot;FLOAT&quot;, double.class)); // 6</span>
<span class="fc" id="L112">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.DOUBLE, &quot;DOUBLE&quot;, double.class)); // 8</span>
<span class="fc" id="L113">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.BINARY, &quot;BINARY&quot;, byte[].class)); // -2</span>
<span class="fc" id="L114">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.VARBINARY, &quot;VARBINARY&quot;, byte[].class)); // -3</span>
<span class="fc" id="L115">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.LONGVARBINARY, &quot;LONGVARBINARY&quot;, byte[].class)); // -4</span>
<span class="fc" id="L116">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.DATE, &quot;DATE&quot;, java.sql.Date.class)); // 91</span>
<span class="fc" id="L117">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.TIME, &quot;TIME&quot;, java.sql.Time.class)); // 92</span>
<span class="fc" id="L118">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.TIMESTAMP, &quot;TIMESTAMP&quot;, java.sql.Timestamp.class)); // 93</span>
<span class="fc" id="L119">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.CLOB, &quot;CLOB&quot;, java.sql.Clob.class)); // 2005</span>
<span class="fc" id="L120">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.BLOB, &quot;BLOB&quot;, java.sql.Blob.class)); // 2004</span>
<span class="fc" id="L121">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.ARRAY, &quot;ARRAY&quot;, java.sql.Array.class)); // 2003</span>
<span class="fc" id="L122">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.REF, &quot;REF&quot;, java.sql.Ref.class)); // 2006</span>
<span class="fc" id="L123">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.DISTINCT, &quot;DISTINCT&quot;, Object.class)); // 2001</span>
<span class="fc" id="L124">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.STRUCT, &quot;STRUCT&quot;, Object.class)); // 2002</span>
<span class="fc" id="L125">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.OTHER, &quot;OTHER&quot;, Object.class)); // 1111</span>
<span class="fc" id="L126">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.JAVA_OBJECT, &quot;JAVA_OBJECT&quot;, Object.class)); // 2000</span>
<span class="fc" id="L127">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.DATALINK, &quot;DATALINK&quot;, java.net.URL.class)); // 70</span>
<span class="fc" id="L128">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.BIT, &quot;BIT&quot;, boolean.class)); // -7</span>
<span class="fc" id="L129">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(java.sql.Types.BOOLEAN, &quot;BOOLEAN&quot;, boolean.class)); //16</span>

    // dbspecific types needed to generate the class from a function.
<span class="fc" id="L132">    dataTypeMapper.addDataTypeEntry(new DataTypeMapEntry&lt;&gt;(100, &quot;VARCHAR_IGNORECASE&quot;, java.lang.String.class)); // HSQLDB TYPE for VARCHAR_IGNORE_CASE</span>

<span class="fc" id="L134">    logger.debug(&quot;Returning the DataMapper&quot;);</span>
<span class="fc" id="L135">    return dataTypeMapper;</span>
  }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span></div></body></html>